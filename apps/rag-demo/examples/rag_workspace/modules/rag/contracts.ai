record "Document":
  fields:
    document_id is text must be present
    upload_id is text must be present
    `title` is text must be present
    status is text must be present
    quality is text must be present

record "Citation":
  fields:
    id is text must be present
    citation_id is text must be present
    query is text must be present
    document_id is text must be present
    page_number is number must be present
    chunk_id is text must be present
    source_id is text must be present
    source_title is text must be present
    snippet is text must be present

record "Answer":
  fields:
    query is text must be present
    response is text must be present
    status is text must be present
    confidence is number must be present
    coverage is number must be present
    source_count is number must be present

record "ExplainEntry":
  fields:
    stage is text must be present
    detail is json must be present

record "EvalRun":
  fields:
    query is text must be present
    status is text must be present
    source_count is number must be present
    coverage is number must be present

contract flow "rag.ingest_latest":
  input:
  output:
    status is text

contract flow "rag.answer_query":
  input:
    query is text
    message is text
  output:
    status is text
    source_count is number

contract flow "rag.open_citation":
  input:
    citation_id is text
    source_id is text
  output:
    status is text

contract flow "rag.open_sources":
  input:
  output:
    status is text

contract flow "rag.close_sources":
  input:
  output:
    status is text

contract flow "rag.run_eval_smoke":
  input:
    query is text
  output:
    status is text
